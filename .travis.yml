language: rust
rust:
- stable
- nightly
matrix:
  allow_failures:
  - rust: nightly
env:
  global:
  - secure: h6K7tf04mCj27b/Py9/l75E8hSNATeRKRXVir74XJV3o5nSpHKrf/eElyzl8O4vaxoij1MKcozJt35logPXnkNM7gIqNPtuSvZYc2J9lDN8sNxFQhzNJ7YljF72GecVDgLTyBkyIR97CNRI1qa9BKe8TBVctMlUhrvfLPAPU7C4PP1SXJJqBGGZVURVeU1C++asPySFUzke8/MBoxGjY3OGvAABQQdXYeWqopg/YDuEs+8i+ZYArEkkYqrUi9wwkrtzB5lgH7lB4x571OWWLU9VACUuqRg9NLVXPKy98Swc+pxqWwawSfx7EsUHtP1bEDPJKMjXIqnUChMt0JMdFkWLjEYvTsLOgmIKr00Z9aJligenECWJ51ZCUTugWVceawKRmksvHjZdmYoqc2+kziBQuB8bBm9YgLVbSDgAcKulsVrec5DpDLBYRb7Pm9DzA8Ix8n6NUh0akGDblnUDZq5Yb1hSyqX/SffDndUYNDOpZTJqQRAh/ezdll8qeymMIY6Om8p+iw5qlPe4cozwUG7XikC/MHQRzUSxsSyVo7UAubSSdogHMM70xsaSH47zbsUIoNMuPIvJ7IP+QcX6PLL6lVbKDvv2MkflOVleh6m5gF/KNiMrTVSkq1GeCKhCMV4AIZuyGNrFa8OGR3PKC11rQWzMMjFZE3JFcMIYlft4=
  - secure: Tw3HYB6SFuqFRkKNqYWvAoKW9rucjIC5HIar6uDnoFikkXQ2+8f0bIf7SHbX7a+ePWODXHWblBoWdsCsJuUKmQ9HQ70A857akHKK3kXRGPtzyQs03sawK5yhtYSTFAewktPQR6iD+BvHfZ70QcoyyO6vac7mcbY0LUHvn0nweIrCmV7cZ/BQS0uk48hHhkrXAOBwgJ51/MdprxYN6Rw84luYs7aaJtbE0MIPRUM3rDJIXC931t2X3nNE9Mogyq9Kn/AyqB+6oteyZWOJjcACCC7cPtk3HhXpPvWFdMzxdZpfjPQSHzjnxmWVo0+qJ4WnpdPKBzdlmUC72tEaqkBNHFTqqSfFFJEcRCHMWcfCDu70kAjcKQmK1AVBj/HWD2T48i1l75R5JKUoNNo/w61mNqru0Sowm2a98MAS1L4m8iS+6HH5HU9szWodDOyJsTmafyn4OPDiMSTYS/690H961XVLUusW2pTwclHXbAWr04bXD5CH9iS8gBL0PUYW8qn9+FIxg/mpMWlivLI1LPTZ2TWeCe6REiHI6aCfaiYafd8RB8YHTNZaEORg7DH4pFK27hPr+voZG1Q6JtIlULNTFKWOwUT9GKVg8VfaY3oZBxLGca67VhCE/7eKkjbAdrPgI7ew9+YqTzjSuWDfrfAVZ+uA6zr4bqD/rywMNYXrSa4=
script:
- cargo test --verbose
after_success:
- |
  [ $TRAVIS_RUST_VERSION = stable ] &&
  [ $TRAVIS_BRANCH = master ] &&
  [ $TRAVIS_PULL_REQUEST = false ] &&
  cargo doc &&
  sudo pip install ghp-import &&
  ghp-import -n target/doc &&
  git push -fq https://${GH_TOKEN}@github.com/${TRAVIS_REPO_SLUG}.git gh-pages
- |
  [ $TRAVIS_RUST_VERSION = stable ] &&
  [ $TRAVIS_BRANCH = master ] &&
  [ $TRAVIS_PULL_REQUEST = false ] &&
  cargo publish --token ${CRATESIO_TOKEN}
